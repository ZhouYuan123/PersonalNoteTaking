# C++

## 1. ç®€ä»‹

1979 - 1981: C with classes

ä»1982å¹´å¼€å§‹ï¼ŒC++å¼€å§‹å®šä½ä½œä¸ºä¸€ä¸ªæ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½¿ç”¨ç¼–è¯‘æŠ€æœ¯é‡æ–°å®ç°äº†ã€Œå¸¦ç±»çš„Cã€ï¼Œå¯¹åº”çš„ç¼–è¯‘å™¨ä¸ºCfront

1983å¹´åº•ï¼ŒC++æ­£å¼è¢«å‘½åã€‚

```c++
#include <iostream> // a PREPROCESSOR directive, è¯¥ç¼–è¯‘æŒ‡ä»¤å¯¼è‡´é¢„å¤„ç†å™¨å°†iostreamæ–‡ä»¶çš„å†…å®¹æ·»åŠ åˆ°ç¨‹åºä¸­ã€‚è¿™æ˜¯ä¸€ç§å…¸å‹çš„é¢„å¤„ç†å™¨æ“ä½œ:åœ¨æºä»£ç è¢«ç¼–è¯‘ä¹‹å‰ï¼Œæ›¿æ¢æˆ–æ·»åŠ æ–‡æœ¬ã€‚
using namespace std;
int main(void)
{
    cout << "Hello World" << endl;
    return 0;
}
```

C++ èåˆäº†3ç§ä¸åŒçš„ç¼–ç¨‹æ–¹å¼ï¼š **è¿‡ç¨‹æ€§è¯­è¨€ + OOP + æ³›å‹ç¼–ç¨‹**

æ–‡ä»¶åç¼€: `cpp, cxx, cc`

ç¼–è¯‘ï¼š`g++ 1.cpp`, è¿è¡Œï¼š`./a.out` (é€šå¸¸,main()è¢«å¯åŠ¨ä»£ç è°ƒç”¨,è€Œå¯åŠ¨ä»£ç æ˜¯ç”±ç¼–è¯‘å™¨æ·»åŠ åˆ°ç¨‹åºä¸­çš„,æ˜¯ç¨‹åºå’Œæ“ä½œç³»ç»Ÿ(UNIXã€Windows7æˆ–å…¶ä»–æ“ä½œç³»ç»Ÿ)ä¹‹é—´çš„æ¡¥æ¢ã€‚äº‹å®ä¸Šï¼Œè¯¥å‡½æ•°å¤´æè¿°çš„æ˜¯main()å’Œæ“ä½œç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚) å­˜åœ¨ä¸€äº›ä¾‹å¤–æƒ…å†µã€‚ä¾‹å¦‚,åœ¨ Windowsç¼–ç¨‹ä¸­,å¯ä»¥ç¼–å†™ä¸€ä¸ªåŠ¨æ€é“¾æ¥åº“(DLL)æ¨¡å—,è¿™æ˜¯å…¶ä»– Windowsç¨‹åºå¯ä»¥ä½¿ç”¨çš„ä»£ç ã€‚ç”±äº DLL æ¨¡å—ä¸æ˜¯ç‹¬ç«‹çš„ç¨‹åºï¼Œå› æ­¤ä¸éœ€è¦ main()ã€‚ç”¨äºä¸“ç”¨ç¯å¢ƒçš„ç¨‹åº--å•ç‰‡æœºï¼Œåªéœ€è¦ä»£ç åœ°å€ï¼Œä¹Ÿä¸éœ€è¦main.

ğŸŸ© **ä¸C** ğŸŸ©

å•è¡Œæ³¨é‡Šï¼š`//`      æ”¯æŒç‰ˆæœ¬ C99, C++

å¤šè¡Œæ³¨é‡Šï¼š`/* */`     æ”¯æŒç‰ˆæœ¬ C89, C99, C++

æ–‡æ¡£æ³¨é‡Š : `/** æ–‡æ¡£æ³¨é‡Š */` ï¼ˆæ ‡å‡†ä¸­æ²¡æœ‰æï¼‰

* é¢å‘è¿‡ç¨‹ï¼šå°±æ˜¯åˆ†æå‡ºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å®ç°ï¼Œä½¿ç”¨çš„æ—¶å€™å†ä¸€ä¸ªä¸€ä¸ªçš„ä¾æ¬¡è°ƒç”¨å°±å¯ä»¥äº†ã€‚
* é¢å‘å¯¹è±¡ï¼šæ˜¯æŠŠäº‹åŠ¡åˆ†è§£æˆä¸ºä¸€ä¸ªä¸ªå¯¹è±¡ï¼Œç„¶åç”±å¯¹è±¡ä¹‹é—´åˆ†å·¥ä¸åˆä½œ
  * ç‰¹ç‚¹ï¼šå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€

C++æ˜¯Cè¯­è¨€çš„è¶…é›†ï¼Œä»»ä½•æœ‰æ•ˆçš„Cç¨‹åºéƒ½æ˜¯æœ‰æ•ˆçš„C++ç¨‹åºã€‚

Cæä¾›äº†ä½çº§ç¡¬ä»¶è®¿é—®ï¼ŒOOPæä¾›äº†é«˜çº§æŠ½è±¡ã€‚

ç‰ˆæœ¬ä¸‰å¹´ä¸€ä¸ªå‘¨æœŸï¼Œä¸»è¦ç‰ˆæœ¬: **C++98**ï¼Œ**C++11**ï¼Œ**C++17**,  **C++23**

 **å¤´æ–‡ä»¶** 

è½¬æ¢åçš„CåŠ ä¸Šå‰ç¼€Cï¼Œæ²¡æœ‰æ‰©å±•åï¼Œä¾‹å¦‚ `cstdio`, `cmath`ï¼Œ`ctype`ç­‰ã€‚

`#include <cstdio> ` : `cstdio` æºæ–‡ä»¶ä¸­è¿˜æ˜¯ `#include <stdio.h> `

 **char** 

`\n ` ä¸ `endl` : å‰è€…åªæ¢è¡Œï¼Œåè€…æ¢è¡Œå¹¶ + `fflush(stdin)`(ç«‹å³è¾“å‡º)

```c++
cout << "25"; // printf("%s\n", "25");
cout << 25; // printf("%d\n", 25);
```

`wchar_t` : å®½å­—ç¬¦ç±»å‹, å¯ä»¥è¡¨ç¤ºæ‰©å±•å­—ç¬¦é›†. C++11æ–°å¢çš„ç±»å‹:char16_t å’Œ char32_t

æ–°çš„æ•°æ®ç±»å‹stringã€‚

## 2. æ•°æ®ç±»å‹

### 2.1 åŸºæœ¬ç±»å‹

| æ•´å‹              | é•¿åº¦                                                         |
| ----------------- | ------------------------------------------------------------ |
| char (å¦ä¸€ç§æ•´å‹) | 1 byte                                                       |
| short             | short è‡³å°‘ 2 byte                                            |
| int               | int è‡³å°‘ä¸ short ä¸€æ ·é•¿                                      |
| long              | long è‡³å°‘ 8 byteï¼Œä¸”è‡³å°‘ä¸ int ä¸€æ ·é•¿                        |
| long long         | long long è‡³å°‘ 8 byteï¼Œä¸”è‡³å°‘ä¸ long ä¸€æ ·é•¿ã€‚(**C++11æ–°å¢**) |

| boolç±»å‹ | é•¿åº¦   |
| -------- | ------ |
| bool     | 1 byte |

| æµ®ç‚¹ç±»å‹    | é•¿åº¦             |
| ----------- | ---------------- |
| float       | è‡³å°‘ 4 byte      |
| double      | è‡³å°‘ 6 byte      |
| long double | è‡³å°‘å’Œdoubleä¸€æ · |

floatå®šä¹‰: `1.0f`

è¿™äº›éƒ½æœ‰ `unsigned, signed`

C++æ•´æ•°å¸¸é‡åœ¨ä¸è¶…å‡ºintç±»å‹èŒƒå›´çš„åº”ç”¨æƒ…å†µä¸‹ï¼Œé»˜è®¤ä¼˜å…ˆä½¿ç”¨intç±»å‹

```c++
// 1. char
char a = 65; // 'A'
char a = 'A'; // å­—é¢å€¼65
int b = a;
cout << b; // 65

a = a + 1;
cout << a; // B
cout.put('a'); // ç”¨æ¥è¾“å‡ºå­—ç¬¦: a

// 2. bool
bool is_ready = true;
int ans = true;      // 1
int promise = false; // 0
bool start = -100;   // true
bool start = 0;      // false

// 3. æµ®ç‚¹æ•°
12.34, 2.52e+8
// æ§åˆ¶æ˜¾ç¤ºçš„å°æ•°çš„ä½æ•° <iomanip>
cout << cout.setprecision(2);
cout.setf(); // ä¿ç•™å°æ•°ç»“å°¾0. couté»˜è®¤ä¼šåˆ é™¤å°æ•°ç»“å°¾çš„0, é»˜è®¤6ä½å°æ•°

// ç±»å‹è½¬æ¢
long_num = short_num; // å°è½¬å¤§è‡ªåŠ¨è½¬æ¢
int_num = float_num;  // ä¸¢å¤±
auks = 19.99 + 11.99; // 31
auto n = 100; // C++11, int

// å¼ºåˆ¶ç±»å‹è½¬æ¢
(typeName)value
typeName(value)
static_cast<typeName>(value)

// å¸¸é‡ï¼Œé¦–å†™å­—ç¬¦å¤§å†™
const int Months = 12;

int emus;    // å±€éƒ¨å˜é‡å€¼ä¸å®šä¹‰ï¼Œè¿™ä¸ªå€¼ä¼šæ˜¯ä»»æ„å€¼ã€‚
int emus{7}; // ä½¿ç”¨å¤§æ‹¬å·åˆå§‹åŒ–å™¨ã€‚è¿™ç§æ–¹å¼é€‚åˆä»»æ„æ•°æ®ç±»å‹ã€‚
```

### 2.2 å¤åˆç±»å‹

ğŸŸ¦  **ä¸€ã€ æ•°ç»„**

åŒCè¯­è¨€ã€‚

**å­—ç¬¦ä¸²**

åŒCè¯­è¨€éƒ¨åˆ†ã€‚

æ‹¼æ¥å­—ç¬¦ä¸²å¸¸é‡ï¼šä»»ä½•ä¸¤ä¸ªç”±ç©ºç™½(ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦å’Œæ¢è¡Œç¬¦)åˆ†éš”çš„å­—ç¬¦ä¸²å¸¸é‡éƒ½å°†è‡ªåŠ¨æ‹¼æ¥æˆä¸€ä¸ªã€‚

**string ç±»**

```c++
#include <cstring>
string str = "abc"; // å¯ä»¥é€šè¿‡ä¸‹æ ‡è®¿é—®å„å…ƒç´ 
str.size();         // 3
charr2 = charr1;    // INVALID, no array assignment
str1 = str2;        // VALID, object assignment ok
// å¯ä»¥å­—ç¬¦ä¸²æ‹¼æ¥
str3 = str1 + str2;
str1 += str2;

char charr[20];
string str;
strlen(charr); // éšæœº
str.size();    // 0

// é‡è½½äº†æ¯”è¾ƒè¿ç®—ç¬¦ ==, !=, <, <=, >, >=
// ç”¨é€”ï¼šæŒ‰å­—å…¸åºæ¯”è¾ƒå­—ç¬¦ä¸²å†…å®¹ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰
if ("apple" < "banana") { /* true */ }
if (s1 == s2) { /* åˆ¤æ–­å†…å®¹æ˜¯å¦ç›¸åŒ */ }
```

ğŸŸ¦  **äºŒã€ ç»“æ„ä½“**

```c++
// 1ã€å…ˆå®šä¹‰ç»“æ„ä½“ç±»å‹ï¼Œå†å®šä¹‰ç»“æ„ä½“å˜é‡
struct inflatable
{
    std::string name;
    float volume;
    double price;
};
inflatable hat; // Cè¯­è¨€ï¼š struct inflatable hat;
hat = { "abc", 3.12, 32.99 };
hat.name; // è·å–
inflatable hat { "abc", 3.12, 32.99 }; // C++11

// 2ã€å®šä¹‰ç»“æ„ä½“ç±»å‹çš„åŒæ—¶å®šä¹‰ç»“æ„ä½“å˜é‡
struct inflatable
{
    std::string name;
}abc, def;

// 3ã€ç›´æ¥å®šä¹‰ç»“æ„ä½“å˜é‡ (åŒ¿åç»“æ„ä½“ç±»å‹)
struct
{
    float volume;
}abc, def;

inflatable hat[100]; // ç»“æ„ä½“æ•°ç»„ã€‚åˆå§‹åŒ–: {{"abc"},{"def"}}
```

ğŸŸ¦  **ä¸‰ã€ è”åˆä½“**

```c++
union one4all
{
    int int_val;
    long long_val;
    double double_val;
};

// å¯ä»¥ä½¿ç”¨ one4all å˜é‡æ¥å­˜å‚¨intã€longæˆ– doubleï¼Œæ¡ä»¶æ˜¯åœ¨ä¸åŒçš„æ—¶é—´è¿›è¡Œ:
one4all pail;
pail.int_val = 15;    //store an int
cout << pail.int_val;
pail.double_val=1.38; //store adouble,int value is lost
// å› æ­¤ï¼Œpail æœ‰æ—¶å¯ä»¥æ˜¯ int å˜é‡ï¼Œè€Œæœ‰æ—¶åˆå¯ä»¥æ˜¯ double å˜é‡ã€‚æˆå‘˜åç§°æ ‡è¯†äº†å˜é‡çš„å®¹é‡ã€‚ç”±äºå…±ç”¨ä½“æ¯æ¬¡åªèƒ½å­˜å‚¨ä¸€ä¸ªå€¼ï¼Œå› æ­¤å®ƒå¿…é¡»æœ‰è¶³å¤Ÿçš„ç©ºé—´æ¥å­˜å‚¨æœ€å¤§çš„æˆå‘˜ï¼Œæ‰€ä»¥ï¼Œå…±ç”¨ä½“çš„é•¿åº¦ä¸ºå…¶æœ€å¤§æˆå‘˜çš„é•¿åº¦ã€‚
```

ğŸŸ¦  **å››ã€ æšä¸¾**

åŒCè¯­è¨€ã€‚

### 2.3 æŒ‡é’ˆ

æŒ‡é’ˆæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼ˆæ•´æ•°ï¼‰ï¼Œè¿™ç§ç±»å‹å®šä¹‰å‡ºçš„å˜é‡å«æŒ‡é’ˆå˜é‡ï¼ˆç®€ç§°æŒ‡é’ˆï¼‰ã€‚

```c++
int updates = 6;
int* p_updates; // Cç¨‹åºå‘˜ä¹ æƒ¯ï¼šint *p_updates;
p_updates = &updates; // å€¼ï¼šåœ°å€
*p_updates;           // å€¼ï¼š6
*p_updates = *p_updates + 1;
cout << updates;      // 7

int* p1, p2; // p1æ˜¯int*ç±»å‹, p2æ˜¯intç±»å‹

long * fellow;
*fellow = 223323; // é‡æŒ‡é’ˆç›´æ¥èµ‹å€¼ï¼Œå±é™©
pt = 0xB8000000;  // type mismatch, ä¸èƒ½ç»™æŒ‡é’ˆç›´æ¥èµ‹å€¼int
```

ğŸŸ¦  **åŠ¨æ€å†…å­˜**

```c++
int * p = new int;
int * p = new int(6);  // åˆå§‹åŒ– *pi set to 6
int * p = new int{6};  // åˆå§‹åŒ– *pi set to 6
/*
 * é‡Šæ”¾å†…å­˜
 * 1. é‡å¤é‡Šæ”¾æŠ¥é”™
 * 2. deleteç©ºæŒ‡é’ˆæ˜¯å®‰å…¨çš„
 * 3. ä¸ä¼šåˆ é™¤æŒ‡é’ˆï¼Œå¯ä»¥å°†pé‡æ–°æŒ‡å‘å¦ä¸€ä¸ªæ–°åˆ†é…çš„å†…å­˜å—ã€‚
 */
delete p;

int *pi = &jugs;
delete pi;   // not allowed, memory not allocated by new

// é™æ€è”ç¼–ï¼Œæ•°ç»„çš„é•¿åº¦åœ¨ç¼–è¯‘æ—¶è®¾ç½®ã€‚
int arr[5];
// åŠ¨æ€è”ç¼–ï¼ŒåŠ¨æ€æ•°ç»„ï¼Œç¨‹åºè¿è¡Œæ—¶æ‰ä¼šåˆ›å»ºæ•°ç»„ã€‚
int * intArray = new int[10]; // 10å¯ä»¥æ˜¯å˜é‡
delete [] intArray;

// å®šä½newï¼Œä¸èƒ½delete
#include <new>
```

`nullptr` : ç©ºæŒ‡é’ˆï¼Œ0ï¼›

ğŸŸ¦  **å¼•ç”¨**

```c++
/* å¼•ç”¨ reference
 * 1. åªèƒ½æŒ‡å‘å˜é‡ï¼Œå¿…é¡»ç«‹å³åˆå§‹åŒ–
 * 2. åªæœ‰ç©ºæŒ‡é’ˆï¼Œæ²¡æœ‰ç©ºå¼•ç”¨
 */
int int_value = 1024;
int& refValue = int_value; // int* const refValue = &int_value;
refValue = 10; // *refValue = 10;

const double& d = 12.3; // å¸¸é‡å¼•ç”¨
```

## 3. cinå’Œcoutæµ

```c++
// 1. cout
int chest = 42;    // cout: 42
int waist = 0x42;  // cout: 66
int inseam = 042;  // cout: 34
cout << hex;
cout << waist: // æ‰“å°å‡ºï¼š42
cout << oct;
cout << inseam: // æ‰“å°å‡ºï¼š42

// å¼ºåˆ¶ä»¥å°æ•°çš„æ–¹å¼æ˜¾ç¤º
cout << fixed;

cout << hex; // ä»¥16è¿›åˆ¶æ˜¾ç¤º
cout << oct; // å…«è¿›åˆ¶

// è®¾ç½®æ‰“å°å®½åº¦ <iomanip> é»˜è®¤å³å¯¹é½
int n = 10;
cout << left;
cout << setfill('_');
cout << setw(n) << 3.14; // _____3.14

// å¯ä»¥æ‰“å°å‡º 'true' 'false'
cout << boolalpha;
bool flag = true;
cout << flag;	// è¾“å‡º "1"ï¼Œä½¿ç”¨äº† boolalpha åˆ™æ˜¯ "true"
cout.setf(ios_base::boolalpha);

// 2.é”®ç›˜å½•å…¥
int num;
char ch1, ch2;
cin >> num; // å¯ä»¥ä¸€æ¬¡è¾“å…¥13abï¼Œç„¶åç¨‹åºæ‰§è¡ŒæˆåŠŸï¼Œåˆ†å¼€è¯»å–
cin >> ch1;
cin >> ch2;

char ch3;
cin >> ch3; // é”®å…¥5å°±æ˜¯å­—ç¬¦â€˜5â€™

char ch4[20]; // åªèƒ½è¯»19ä¸ª
cin >> ch4; // cin é‡åˆ°ç©ºç™½å­—ç¬¦ç»“æŸï¼Œç©ºç™½åé¢çš„å­—ç¬¦ä¸²åŠ å…¥ç¼“å†²åŒºä½œä¸ºä¸‹ä¸€ä¸ªcinçš„è¾“å…¥å€¼ã€‚
cin.get(ch4, 20);     // æ¯æ¬¡è¯»å–ä¸€è¡Œã€‚å®ƒé€šè¿‡æ¢è¡Œç¬¦æ¥ç¡®å®šè¡Œå°¾ï¼Œæ¢è¡Œç¬¦ä»ç•™åœ¨è¾“å…¥ç¼“å†²åŒºä¸­ã€‚
cin.getline(ch4, 20); // æ¯æ¬¡è¯»å–ä¸€è¡Œã€‚å®ƒé€šè¿‡æ¢è¡Œç¬¦æ¥ç¡®å®šè¡Œå°¾ï¼Œè‡ªåŠ¨ç§»é™¤æ¢è¡Œç¬¦å¹¶ä¸¢å¼ƒã€‚
getline(cin, str);    //

cin.fail();           // true ä»£è¡¨åˆ°æœ«å°¾
cin.clear();          // é‡ç½®é”™è¯¯è¾“å…¥æ ‡è®°

// 3.åˆå§‹åŒ–
int wrens(432); // wrens = 432
int abc {123}; // ğŸŸ¥æ„åœ¨å¸Œæœ›ä»»æ„æ•°æ®ç±»å‹éƒ½å¯ä»¥ä½¿ç”¨{}ğŸŸ¥
int rheas = {123};
int abc {}; 	// abc = 0
int rheas = {}; // rheas = 0

int a = int(99.9);
int a = (int)99.9;
```

## 4. å˜é‡

| ç±»å‹                                   | å®šä¹‰                                           | å­˜å‚¨å’Œå‘¨æœŸ                                                   | ä½œç”¨åŸŸ   | é“¾æ¥æ€§ |
| -------------------------------------- | ---------------------------------------------- | ------------------------------------------------------------ | -------- | ------ |
| å…¨å±€å˜é‡                               | å‡½æ•°å¤–é¢å®šä¹‰çš„ã€‚                               | ä»ç¨‹åºå¯åŠ¨å¼€å§‹ï¼Œåˆ°ç¨‹åºç»“æŸé”€æ¯                               | å…¨å±€     | å¤–éƒ¨   |
| é™æ€å…¨å±€å˜é‡                           | const or static                                | æ•´ä¸ªç¨‹åºè¿è¡ŒæœŸ                                               | å…¨å±€     | å†…éƒ¨   |
| å±€éƒ¨å˜é‡ï¼Œè‡ªåŠ¨å˜é‡(automatic variable) | å‡½æ•°å†…éƒ¨å®šä¹‰çš„å¸¸è§„å˜é‡                         | è‡ªåŠ¨å­˜å‚¨ï¼šåœ¨æ‰€å±çš„å‡½æ•°è¢«è°ƒç”¨æ—¶è‡ªåŠ¨äº§ç”Ÿï¼Œåœ¨è¯¥å‡½æ•°ç»“æŸæ—¶æ¶ˆäº¡ã€‚<br />å±€éƒ¨å˜é‡å†…å­˜è‡ªåŠ¨åˆ†é…å’Œé‡Šæ”¾ã€‚ | ä»£ç å—ä¸­ | æ—      |
| é™æ€å˜é‡                               | ä½¿ç”¨å…³é”®å­— staticï¼š`static double fee =56.50;` | é™æ€å­˜å‚¨ï¼šæ•´ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´éƒ½å­˜åœ¨ã€‚åˆå§‹åŒ–ä¸€æ¬¡ã€‚               | å‡½æ•°å†…éƒ¨ | å†…éƒ¨   |
| åŠ¨æ€å˜é‡                               | newå…³é”®å­—                                      | åŠ¨æ€å­˜å‚¨ï¼šä¸€ç›´å­˜åœ¨ç›´åˆ°ä½¿ç”¨deleteæˆ–è€…ç¨‹åºç»“æŸã€‚è‡ªç”±å­˜å‚¨(freestore)æˆ–å †(heap)ã€‚è¯¥å†…å­˜æ± åŒç”¨äºé™æ€å˜é‡å’Œè‡ªåŠ¨å˜é‡çš„å†…å­˜æ˜¯åˆ†å¼€çš„ã€‚ |          |        |
| å¤–éƒ¨å˜é‡                               | extern                                         | // (å¤´æ–‡ä»¶ä¸­)å£°æ˜å¼•ç”¨å¤–éƒ¨å®šä¹‰çš„å˜é‡                          | å…¨å±€     | å¤–éƒ¨   |

```c++
::abc; // å…¨å±€å˜é‡ä¸­çš„abc
```

**volatile**

é˜²æ­¢ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå¼ºåˆ¶ä»å†…å­˜è¯»å–æœ€æ–°å€¼ã€‚

ç¼–è¯‘å™¨é»˜è®¤ä¼šç¼“å­˜é¢‘ç¹è®¿é—®çš„å˜é‡åˆ°å¯„å­˜å™¨ä¸­ä»¥æé«˜æ•ˆç‡ï¼Œä½†è‹¥å˜é‡å¯èƒ½è¢«å¤–éƒ¨å› ç´ ï¼ˆå¦‚ç¡¬ä»¶ã€å…¶ä»–çº¿ç¨‹ï¼‰ä¿®æ”¹ï¼Œç¼“å­˜ä¼šå¯¼è‡´ç¨‹åºè¯»å–æ—§å€¼ã€‚

**mutable**

å³ä½¿ç»“æ„(æˆ–ç±»)å˜é‡ä¸ºconst,å…¶æŸä¸ªæˆå‘˜ä¹Ÿå¯ä»¥è¢«ä¿®æ”¹

```c++
struct data {
    char name [30];
    mutable int accesses;
}

const data veep = ... // veep ä¸­ accesseså¯ä»¥è¢«ä¿®æ”¹
```

**å·¦å€¼å’Œå³å€¼**

```c++
int a = 10;
int &c = a;        // å·¦å€¼å¼•ç”¨ï¼Œå› ä¸ºaåŸæœ¬æ˜¯å·¦å€¼ã€‚
int &c = 10;       // invalidï¼Œå› ä¸º10æ˜¯å³å€¼ã€‚
const int &c = 10; // å†…å­˜ä¸­åˆ›å»ºäº†ä¸´æ—¶å˜é‡ï¼Œä¸´æ—¶å˜é‡æ˜¯å·¦å€¼ã€‚

int &&x = 10;      // å³å€¼å¼•ç”¨ (C++11)
```

## 5. vectorå’Œarray

ğŸŸ¦ <font color="green">**æ•°ç»„**</font>

`int arr[n]` : nå¯ä»¥æ˜¯å˜é‡ï¼Œä½†åœ¨Cè¯­è¨€ä¸­nå¿…é¡»æ˜¯å¸¸é‡ã€‚

`int days[]{1, 15}`, `int days[100]{}` ï¼šC++11

ğŸŸ¦ <font color="green">**vector**</font>

```c++
#include <vector>
using namespece std;
vector<int> vec;                    // ä½¿ç”¨æ— å‚çš„æ„é€ å‡½æ•°åˆ›å»ºä¸€ä¸ªç©ºçš„vectorå®¹å™¨ã€‚
vector<int> vec = {1, 2, 3, 4, 5};  // ä½¿ç”¨åˆå§‹åŒ–åˆ—è¡¨åˆå§‹åŒ–
vector<int> vec(5);                 // å…ƒç´ ä¸º {0, 0, 0, 0, 0}
vector<int> vec(5, 10);             // å…ƒç´ ä¸º {10, 10, 10, 10, 10}
vector<int> vec2(vec.begin(), vec.end()); // åˆå§‹åŒ–ä¸€ä¸ªä¸vecå…·æœ‰ç›¸åŒå…ƒç´ çš„vectorå®¹å™¨
vector<int> vec3(vec);              // å¤åˆ¶ä¸€ä¸ªä¸vecç›¸åŒçš„vectorå®¹å™¨
vector<int> vec4(arr, arr+5);

clear(); // ç§»é™¤å®¹å™¨ä¸­çš„æ‰€æœ‰æ•°æ®
empty(); // åˆ¤æ–­å®¹å™¨æ˜¯å¦ä¸ºç©º
erase(pos); // åˆ é™¤posä½ç½®å¤„çš„æ•°æ®
erase(beg, end); // åˆ é™¤[beg,end)åŒºé—´çš„æ•°æ®
front(); // è¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ 
insert(pos, elem); // åœ¨posä½ç½®å¤„æ’å…¥ä¸€ä¸ªå…ƒç´ 
pop_back(); // åˆ é™¤æœ€åä¸€ä¸ªå…ƒç´ 
push_back(elem); // åœ¨å®¹å™¨æœ«å°¾æ’å…¥ä¸€ä¸ªå…ƒç´ 
resize(num); // é‡æ–°è®¾ç½®å®¹å™¨å¤§å°
[index]ã€at(index) // è¿”å›ç´¢å¼•ä¸ºindexçš„å…ƒç´ 
// ä¸­æ‹¬å·è¡¨ç¤ºæ³•å’Œæˆå‘˜å‡½æ•°at()çš„å·®åˆ«åœ¨äºï¼Œä½¿ç”¨atæ—¶ï¼Œå°†åœ¨è¿è¡ŒæœŸé—´æ•è·éæ³•ç´¢å¼•ï¼Œè€Œç¨‹åºä¸­è¿™ç§é»˜è®¤é¢å¤–æ£€æŸ¥çš„ä»£ä»·æ˜¯è¿è¡Œæ—¶é—´æ›´é•¿ï¼Œè¿™å°±æ˜¯C++è®©å…è®¸æ‚¨ä½¿ç”¨ä»»ä½•ä¸€ç§è¡¨ç¤ºæ³•çš„åŸå› æ‰€åœ¨ã€‚
```

```c++
// éå†
vector<int> vec = {1, 2, 3, 4, 5};
for (size_t i = 0; i < vec.size(); i++) {
    cout << vec[i] << " ";
}

vector<int> vec = {1, 2, 3, 4, 5};
for (auto it = vec.begin(); it != vec.end(); ++it) {
    cout << *it << " ";
}

// C++11
vector<int> vec = {1, 2, 3, 4, 5};
for (const auto& num : vec) {
    cout << num << " ";
}

// ä½¿ç”¨C++11ä¸­çš„èŒƒå›´-forå¾ªç¯ï¼Œå¯ä»¥ä½¿ç”¨autoå…³é”®å­—è‡ªåŠ¨æ¨å¯¼æ•°æ®ç±»å‹ï¼š
vector<int> vec = {1, 2, 3, 4, 5};
for (auto num : vec) {
    cout << num << " ";
}

#include <iterator>
#include <algorithm>
copy(vec.cbegin(), vec.cend(), ostream_iterator<int>(cout, "åˆ†å‰²ç¬¦"));

// æ’åº ä½¿ç”¨algorithm ä¸­çš„ sort()
```

ğŸŸ¦ **array (C++11)**

é•¿åº¦å›ºå®šã€‚

```c++
#include <array>
using namespace std;
array<int, 5> ai;              // create array object of 5 ints
array<double, 4> ad = {1.2, 2.1, 3.43, 4.3};
ai = ad; // copy
```

## 6. æµç¨‹æ§åˆ¶

åŒCã€‚

```c++
// C++11 æ–°å¢äº†ä¸€ç§å¾ªç¯:åŸºäºèŒƒå›´(range-based)çš„ for å¾ªç¯,
double prices[5] = {4.99, 10.99, 6.87, 7.99, 8.49};
for(double x : prices)
    cout << x << std::endl;
```

## 7. å‡½æ•°

### 7.1 å‚æ•°

```c++
// æ— åå‚æ•°
void foo(int);

// å¦‚æœå®å‚ä¸å¼•ç”¨å‚æ•°ä¸åŒ¹é…ï¼ŒC++å°†ç”Ÿæˆä¸´æ—¶å˜é‡ã€‚å½“ä¸”ä»…å½“å‚æ•°ä¸ºconstå¼•ç”¨æ—¶ï¼ŒC++æ‰å…è®¸è¿™æ ·åšï¼Œä½†ä»¥å‰ä¸æ˜¯è¿™æ ·ã€‚

// é»˜è®¤å‚æ•° (å‡½æ•°å£°æ˜æ—¶)
void sample(int = 10);
void sample(int num)
{
    cout << num << endl;
}

int main()
{
    sample();    // 10
    sample(123); // 123
}
// 1. é»˜è®¤å€¼å¯ä»¥åœ¨å‡½æ•°åŸå‹åŸŸå®šä¹‰ä¸­ç»™å‡ºï¼Œä¸èƒ½åœ¨è¿™ä¸¤ä¸ªä½ç½®åŒæ—¶å‡ºç°
// 2. å¯¹äºå¸¦å‚æ•°åˆ—è¡¨çš„å‡½æ•°ï¼Œå¿…é¡»ä»å³å‘å·¦æ·»åŠ é»˜è®¤å€¼
void test1(int a, int b = 5, int c = 10);
test(1); // å¦‚æœå­˜åœ¨void test1(int a);ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•
test(1, 2);

/*
å‡½æ•°å‚æ•°ä½¿ç”¨constï¼š

1. ä½¿ç”¨ const å¯ä»¥é¿å…æ— æ„ä¸­ä¿®æ”¹æ•°æ®çš„ç¼–ç¨‹é”™è¯¯;
2. ä½¿ç”¨ const ä½¿å‡½æ•°èƒ½å¤Ÿå¤„ç†å®ƒconstå’Œéconst å®å‚ï¼Œå¦åˆ™å°†åªèƒ½æ¥å—é constæ•°æ®;
3. ä½¿ç”¨ const å¼•ç”¨ä½¿å‡½æ•°èƒ½å¤Ÿæ­£ç¡®ç”Ÿæˆå¹¶ä½¿ç”¨ä¸´æ—¶å˜é‡ã€‚
*/

// overloading
// éå¼•ç”¨ç±»å‹å’Œå¼•ç”¨ç±»å‹ä¸èƒ½æ„æˆé‡è½½ï¼ŒæŠ¥é”™ã€‚(é‡è½½å†³è®® æ—¶ä¸åŒºåˆ†å¼•ç”¨)
// constä¸æ„æˆé‡è½½

// å‡½æ•°çš„ç»“å°¾å£°æ˜ä¸ºconst, å‡½æ•°å†…éƒ¨ä¸å…è®¸ä¿®æ”¹å¯¹è±¡æœ¬èº«ã€‚
```

ğŸŸ¦ **æ•°ç»„å‚æ•°**

æ•°ç»„åœ¨ä½œä¸ºå‚æ•°ä¼ é€’æ—¶å®é™…ä¸Šæ˜¯é€€åŒ–ä¸ºæŒ‡é’ˆçš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°ç»„åä½œä¸ºå‡½æ•°å‚æ•°æ—¶ï¼Œä¼ é€’çš„æ˜¯æŒ‡å‘æ•°ç»„é¦–å…ƒç´ çš„æŒ‡é’ˆã€‚å› æ­¤ï¼Œå¦‚æœæ•°ç»„ä½œä¸ºå‚æ•°ä»¥å¼•ç”¨çš„æ–¹å¼ä¼ é€’ï¼Œå®é™…ä¸Šæ˜¯æŒ‡é’ˆçš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„å¼•ç”¨ã€‚

* ä¸å¯ä»¥è¿”å›æ•°ç»„ç±»å‹ã€‚
* ä¸è¦è¿”å›å±€éƒ¨å˜é‡çš„å¼•ç”¨ã€‚
* è¿”å›å¼•ç”¨æ—¶ï¼Œè¦æ±‚å‡½æ•°å‚æ•°ä¸­åŒ…å«è¢«è¿”å›çš„å¼•ç”¨å¯¹è±¡ã€‚

```c++
// å‡½æ•°å¯ä»¥ä¸è¿”å›å€¼ï¼Œé»˜è®¤è¿”å›ä¼ å…¥çš„å¼•ç”¨å¯¹è±¡æœ¬èº«
int& sum(int& num1, int& num2)
{
    num1++;
    num2++; // è¿”å›ä¿®æ”¹åçš„num2, å³é»˜è®¤è¿”å›æœ€åä¸€ä¸ªæ›´æ–°çš„å¼•ç”¨å‡½æ•°
}
int& sum(int& num1, int& num2)
{
    num1++;
    num2++;
    return num1 + num2; // è¿”å›ä¿®æ”¹åçš„num1
}

// è¿”å›å€¼åŠ consté¿å…å·¦å€¼ä¿®æ”¹
const int& sum(int& num){}
sum(num) = 55; // æŠ¥é”™
```

### 7.2 å‡½æ•°å¤šæ€(å‡½æ•°é‡è½½)

å‡½æ•°åå­—ç›¸åŒå‚æ•°ä¸åŒ

* å‚æ•°ï¼šç±»å‹å¼•ç”¨å’Œç±»å‹æœ¬èº«è§†ä¸ºåŒä¸€ä¸ªç‰¹å¾æ ‡
* const è·Ÿ é constå‚æ•°æ˜¯ä¸åŒç‰¹å¾æ ‡ , ä½†è°ƒç”¨çš„æ—¶å€™éconstå¯ä»¥ä½œä¸ºå®å‚è°ƒç”¨constå‡½æ•°
* å‚æ•°ï¼šå·¦å€¼å¼•ç”¨å¯ä»¥è·Ÿå³å€¼å¼•ç”¨æ„æˆé‡è½½ï¼Œä½†å¦‚æœå³å€¼å¼•ç”¨å‡½æ•°æ²¡æœ‰è¢«å®šä¹‰ï¼Œé‚£å°±ä¼šè°ƒç”¨constä¿®é¥°çš„å·¦å€¼å¼•ç”¨çš„å‚æ•°çš„å‡½æ•°

```c++
class A {
    operator const int();
    operator int() const;
}
```

### 7.3 å‡½æ•°æ¨¡æ¿

Function Template

```c++
// å‡½æ•°å£°æ˜
template<typename T> // c++98ä¹‹å‰ï¼š<class T>
void swap(T&, T&);

template<typename T> // æ¨¡æ¿å¤´
void swap(T &a, T &b)
{
    T temp = a;
    a = b;
    b = temp;
}

swap(1, 2);      // è‡ªåŠ¨ç±»å‹æ¨å¯¼ï¼šå¿…é¡»æ¨æµ‹å‡ºä¸€è‡´ç±»å‹çš„T
swap<int>(1, 2); // æ˜¾ç¤ºæŒ‡å®šç±»å‹

// ç¼–è¯‘å™¨æœ€ç»ˆè¿˜æ˜¯ç”Ÿæˆå¤šä¸ªç‹¬ç«‹çš„å‡½æ•°
--
```

**é‡è½½**

1. æ™®é€šå‡½æ•°å¯ä»¥è·Ÿå‡½æ•°æ¨¡æ¿æ„æˆé‡è½½
   1. ä¼˜å…ˆè°ƒç”¨æ™®é€šå‡½æ•°
   2. å¯ä»¥é€šè¿‡ç©ºæ¨¡æ¿å‡½æ•°åˆ—è¡¨å¼ºåˆ¶è°ƒç”¨æ¨¡æ¿
   3. å‡½æ•°æ¨¡æ¿ä¹‹é—´å¯ä»¥æ„æˆé‡è½½
   4. å¦‚æœå‡½æ•°æ¨¡æ¿äº§ç”Ÿæ›´å¥½çš„åŒ¹é…ï¼Œä¼˜å…ˆè°ƒç”¨å‡½æ•°æ¨¡æ¿

```c++
myPrint();       // æ™®é€šå‡½æ•°
myPrint<>();     // æ¨¡æ¿å‡½æ•°
char a = 'a';
myPrint(a); // å‡½æ•°æ¨¡æ¿ï¼šæ™®é€šå‡½æ•°å…¥å‚æ˜¯int, å‡½æ•°æ¨¡æ¿æ˜¯T
```

**æ— æ³•çŸ¥é“æ¨¡æ¿ä¸­å½¢å‚ç±»å‹**

```c++
// C++98
template<class T1,class T2>
void ft(T1 x, T2 Y)
{
	?type? xpy = x + Y; // ä¸çŸ¥é“typeç±»å‹ï¼Œä¾‹å¦‚Xæ˜¯intï¼ŒYæ˜¯short
	// decltype(x + y) xpy = x + y; c++11
}
// c++ 11
// 1. æ²¡æœ‰æ‹¬å·çš„è¡¨è¾¾å¼
int x;
decltype(x) y; // make y the same type as x
decltype(x + y) xpy;
xpy = x + y;

// 2. æ˜¯ä¸€ä¸ªå‡½æ•°è°ƒç”¨
long indeed(int);
decltype(indeed(3)) m; // m is type long
// æ³¨æ„:å¹¶ä¸ä¼šå®é™…è°ƒç”¨å‡½æ•°ã€‚ç¼–è¯‘å™¨é€šè¿‡æŸ¥çœ‹å‡½æ•°çš„åŸå‹æ¥è·æ‚‰è¿”å›ç±»å‹ï¼Œè€Œæ— éœ€å®é™…è°ƒç”¨å‡½æ•°

// 3. æœ‰æ‹¬å·çš„
double xx = 4.4;
decltype((xx)) r2 = xx; // r2 is double &
decltype(xx) w = xx; // w is double (stage 1 match)


// æ–¹æ³•è¿”å›å€¼æ— æ³•æ¨æ–­ç±»å‹, å› ä¸ºå£°æ˜æ—¶è¿˜æ²¡æœ‰ä½¿ç”¨å½¢å‚
template<class T1, class T2>
?type? gt(T1 x, T2 y)
{
    ...
    return x + y;
}
// ä½¿ç”¨c++11æ–°å¢çš„è¯­æ³•å¯ç¼–å†™æˆè¿™æ ·: åç½®è¿”å›ç±»å‹
template<class T1, class T2>
auto gt(T1 x, T2 y) -> decltype(x + y)
{
    ...
    return x + y;
}
```

**æ˜¾å¼å…·ä½“åŒ–å’Œæ˜¾å¼å®ä¾‹åŒ–**

```c++
// æ˜¾å¼å…·ä½“åŒ–æ¨¡æ¿å‡½æ•°
template <>
void Swap<Job>(job &j1, job &j2);

// æ˜¾å¼å…·ä½“åŒ–ï¼Œé’ˆå¯¹ç‰¹æ®Šç±»å‹ç‰¹æ®Šå¤„ç†
template <> void Swap<int>(int &, int &);// explicit specialization
template <> void Swap(int &, int &);     // explicit specialization


// ä¸€èˆ¬æ¨¡æ¿ï¼šéšå¼å®ä¾‹åŒ–(implicit instantiation)
// å‡½æ•°è°ƒç”¨çš„æ—¶å€™æ‰ä¼šç”Ÿæˆä¸€ä¸ªå‡½æ•°å®ä¾‹ï¼ˆæ­¤å‰åªæ˜¯å®šä¹‰ï¼‰

// æ˜¾å¼å®ä¾‹åŒ–(explicit instantiation)
// æ— è®ºå‡½æ•°æ˜¯å¦è°ƒç”¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªå‡½æ•°å®ä¾‹
template void Swap<int>(int,int);       // explicit instantiation
```

ä¾‹å­ï¼š

```c++
template <class T>
void Swap(T &, T &);   // template prototype

template <> void Swap<job>(job &,job &); // explicit specialization for job

int main(void)
{
    template void Swap<char>(char &,char &); // explicit instantiation for char
    short a.b;
    Swap(a,b); // implicit template instantiation for short
    job n, m;
    Swap(nï¼Œm); // use explicit specialization for job
    char g,h;
    Swap(g,h); // use explicit template instantiation for char
}
```

**å‡½æ•°è°ƒç”¨ä¼˜å…ˆçº§**ï¼šéæ¨¡æ¿å‡½æ•° > æ¨¡æ¿å‡½æ•° > æ˜¾å¼å…·ä½“åŒ–æ¨¡æ¿å‡½æ•°

```c++
may('B');
void may(int);                        // #1
float may(float,float=3);             // #2
void may(char);                       // #3
char may(const char &);               // #4
template<class T> void ay(const T &); // #5
// 3>5>6>1>2

may<>(m);    // è‡ªå·±é€‰æ‹©ï¼Œå‘Šè¯‰ç¼–è¯‘å™¨è°ƒç”¨æ¨¡æ¿å‡½æ•°
may<int>(m); // å¼ºåˆ¶ç±»å‹è½¬åŒ–æˆintç±»å‹ç„¶åè°ƒç”¨æ¨¡æ¿
```

### 7.4 å†…ç½®å‡½æ•°

STLå’ŒBoost C++

![](../imgs/Cpp/function.jpg)

```c++
#include <cmath>
int x = sqrt(6.25); // å¹³åˆ†æ ¹: 2.5
double pow(double, double); // å¹³æ–¹

#include <ctime>
clock_t start = clock();           // å½“å‰æ—¶é’ŸèŠ‚æ‹
clock_t delay = secs * CLOCKS_PER_SEC;
while(clock() - start < delay); // ç­‰å¾…æŒ‡å®š secs ç§’
```

## 8. åç§°ç©ºé—´

### 8.1 using

```c++
// using å£°æ˜ï¼Œç›¸å½“äºä¸€ä¸ªå±€éƒ¨å˜é‡
namespace Jill {
    double bucket (double n){...}
    double fetch;
    struct Hill
}
char fetch;
int main(){
    using Jill::fetch; // put fetch into local namespace
    double fetch;      // Error! Already have a local fetch
    cin >> fetch;      // read a value into Jill::fetch
    cin >> ::fetch;    // read a value into global fetch
}

// using ç¼–è¯‘
using namespace Jack;  // make all the names in Jack available
```

ç¼–è¯‘ï¼šä¸éœ€è¦ç¼–è¯‘å¤´æ–‡ä»¶ã€‚

å¤´æ–‡ä»¶ä¸­å¸¸åŒ…å«çš„å†…å®¹ï¼š

> å‡½æ•°åŸå‹ã€‚
>
> ä½¿ç”¨#defineæˆ–constå®šä¹‰çš„ç¬¦å·å¸¸é‡ã€‚
>
> ç»“æ„å£°æ˜ã€‚
>
> ç±»å£°æ˜ã€‚
>
> æ¨¡æ¿å£°æ˜ã€‚
>
> å†…è”å‡½æ•°ã€‚

### 8.2 å‹å…ƒ

1. å‹å…ƒå‡½æ•°ï¼šéæˆå‘˜å‡½æ•°å¯ä»¥è®¿é—®ç§æœ‰æ•°æ®ã€‚

## 9. ç±»å’Œå¯¹è±¡

å°è£…ï¼Œç»§æ‰¿å’Œå¤šæ€ã€‚

ç»§æ‰¿åˆ†ç±»ï¼šå…¬å…±ç»§æ‰¿ï¼Œä¿æŠ¤ç»§æ‰¿å’Œç§æœ‰ç»§æ‰¿ã€‚æ‰€æœ‰å±æ€§éƒ½ç»§æ‰¿ä¸‹æ¥ä¿ç•™ä¸€ä»½ï¼Œç§æœ‰æˆå‘˜æ˜¯è¢«ç¼–è¯‘å™¨å½±è—äº†æ‰€ä»¥æ— æ³•è®¿é—®ã€‚

![](../imgs/Cpp/extend.png)

```c++
class Base {
public:
    int publicVar;
protected:
    int protectedVar;
private:
    int privateVar;
};

class Derived : virtual public Base1, Base2 {
    // publicVar åœ¨æ­¤ä»æ˜¯ public
    // protectedVar åœ¨æ­¤ä»æ˜¯ protected
    // privateVar ä¸å¯ç›´æ¥è®¿é—®
};

Derived d;
d.publicVar;
d.Base::publicVar; // è°ƒç”¨è·Ÿçˆ¶ç±»åŒåå±æ€§æˆ–è€…æ–¹æ³•ï¼Œéœ€è¦åŠ ä¸Šä½œç”¨åŸŸ
Derived::Base::publicVar; // è°ƒç”¨è·Ÿçˆ¶ç±»åŒåçš„é™æ€å±æ€§æˆ–è€…æ–¹æ³•

virtual // è™šç»§æ‰¿è§£å†³è±å½¢ç»§æ‰¿å‡ºç°ä¸¤ä»½æ•°æ®çš„é—®é¢˜ã€‚åªæœ‰ä¸€ä»½æ•°æ®
```

### 9.1 æˆå‘˜

å…³é”®å­—class

* é»˜è®¤æˆå‘˜æ˜¯ç§æœ‰ï¼Œ(structé»˜è®¤æ˜¯å…±æœ‰)
* `::` : ä½œç”¨åŸŸè§£æè¿ç®—ç¬¦ã€‚
* æˆå‘˜åå­—ä¸€èˆ¬ä»¥ `m_` å¼€å¤´
* `static const int Months = 12`; é™æ€æˆå‘˜å±æ€§æ‰€æœ‰å¯¹è±¡å…±äº«

hppæ–‡ä»¶ä¸€èˆ¬åŒ…å«å®ç°çš„å†…è”å‡½æ•°,é€šå¸¸ç”¨äºæ¨¡æ¿ç±»è¿™ç§å£°æ˜ä¸å®ç°å…±å­˜çš„æƒ…å†µã€‚

å»ºè®®: åªè¦ä¸æ˜¯çº¯æ¨¡æ¿ï¼Œä¸€å¾‹ä½¿ç”¨.hä½œä¸ºå¤´æ–‡ä»¶åç¼€ï¼Œä½¿ç”¨.cppæ–‡ä»¶ä½œä¸ºå‡½æ•°çš„å®ç°æ–‡ä»¶ã€‚

**é™æ€æˆå‘˜å˜é‡**

- æ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä»½æ•°æ®
- åœ¨ç¼–è¯‘é˜¶æ®µåˆ†é…å†…å­˜
- ç±»å†…å£°æ˜ï¼Œç±»å¤–åˆå§‹åŒ– (å¿…é¡»åˆå§‹åŒ–ï¼Œå¦åˆ™ä½¿ç”¨æ—¶æŠ¥é”™ `int Stu::m_A = 100;`)åˆå§‹åŒ–æ—¶ä½¿ç”¨ä½œç”¨åŸŸè¿ç®—ç¬¦æ¥æŒ‡å‡ºé™æ€æˆå‘˜æ‰€å±çš„ç±»ã€‚ä½†å¦‚æœé™æ€æˆå‘˜æ˜¯æ•´å‹æˆ–æšä¸¾å‹constï¼Œåˆ™å¯ä»¥åœ¨ç±»å£°æ˜ä¸­åˆå§‹åŒ–ã€‚

**é™æ€æˆå‘˜å‡½æ•°**

- æ‰€æœ‰å¯¹è±¡å…±äº«åŒä¸€ä¸ªå‡½æ•°
- é™æ€æˆå‘˜å‡½æ•°åªèƒ½è®¿é—®é™æ€æˆå‘˜å˜é‡

<font color="green">**è®¿é—®ä¿®é¥°ç¬¦**</font>

> public : ä¿®é¥°çš„æˆå‘˜åœ¨ä»»æ„åœ°æ–¹éƒ½å¯ä»¥è®¿é—®
>
> private : ä¿®é¥°çš„æˆå‘˜åªèƒ½å¤Ÿåœ¨ç±»ä¸­æˆ–è€…å‹å…ƒå‡½æ•°ä¸­å¯ä»¥è®¿é—®
>
> protected : ä¿®é¥°çš„æˆå‘˜å¯ä»¥åœ¨ç±»ä¸­å‡½æ•°ã€å­ç±»å‡½æ•°åŠå‹å…ƒå‡½æ•°ä¸­è®¿é—®

<font color="green">**å¯¹è±¡åˆ›å»º**</font>

```c++
Person person(); // X, è¿™æ˜¯ä¸€ä¸ªå‡½æ•°å£°æ˜
Person person; // éšå¼è°ƒç”¨é»˜è®¤æ„é€ 
Person person = Person(); // æ˜¾å¼è°ƒç”¨é»˜è®¤æ„é€ 
Person *pPerson = new Person();
Person *pPerson = new Person;

Person person2("name2", 27);// ä¼šåˆ›å»ºä¸´æ—¶å¯¹è±¡
Person person = Person("name1", 26); // æ˜¾ç¤ºè°ƒç”¨ã€‚åˆ›å»ºä¸€ä¸ªä¸´æ—¶å¯¹è±¡ï¼Œç„¶åå°†ä¸´æ—¶å¯¹è±¡å¤åˆ¶åˆ°personä¸­
Person *pPerson3 = new Person("name3", 8);// ä¸ä¼šåˆ›å»ºä¸´æ—¶å¯¹è±¡
Person person = 25; // å½“æ„é€ æ–¹æ³•å½¢å‚åªæœ‰ä¸€ä¸ªå¯ä»¥ç”¨ç­‰å·ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨è°ƒç”¨æ„é€ ã€‚å«è½¬æ¢æ„é€ ã€‚

// C++11ï¼Œåˆ—è¡¨åˆå§‹åŒ–ã€‚åªè¦æä¾›çš„å¤§æ‹¬å·åˆ—è¡¨ä¸­çš„æ•°æ®ä¸æŸä¸ªæ„é€ å‡½æ•°çš„å‚æ•°åˆ—è¡¨åŒ¹é…å°±å¯ä»¥ã€‚
Person person{};// ä¸é»˜è®¤æ„é€ å‡½æ•°ç›¸åŒ¹é…
Person person = Person{};
Person *pPerson = new Person{};
Person person4 = {};

Person person{"name5", 26};
Person person5 = Person{"name5", 26};// c++11ï¼Œä¼šåˆ›å»ºä¸´æ—¶å¯¹è±¡
Person *pPerson6 = new Person{"name6", 26};// c++11ï¼Œä¸ä¼šåˆ›å»ºä¸´æ—¶å¯¹è±¡
Person person4 = {"name4", 26};// c++11ï¼Œä¼šåˆ›å»ºä¸´æ—¶å¯¹è±¡

// æ‹·è´æ„é€ å‡½æ•°
Person person2(person); // ä½¿ç”¨æ‹·è´æ„é€ å‡½æ•°åˆ›å»ºæ–°å¯¹è±¡

// é‡è½½èµ‹å€¼è¿ç®—ç¬¦
Person person2 = person; // ä½¿ç”¨é‡è½½ç­‰äºå·è¿ç®—ç¬¦èµ‹å€¼

Stock mystuff[4]; // ä½¿ç”¨é»˜è®¤æ„é€ åˆ›å»ºäº†4ä¸ªå¯¹è±¡
```

### 9.2 å‡½æ•°

C++è‡ªåŠ¨æä¾›äº†ä¸‹é¢è¿™äº›æˆå‘˜å‡½æ•°:

* é»˜è®¤æ„é€ å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰æ„é€ å‡½æ•°;
* é»˜è®¤ææ„å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰;
* å¤åˆ¶æ„é€ å‡½æ•°ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰;
* èµ‹å€¼è¿ç®—ç¬¦ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰;
* åœ°å€è¿ç®—ç¬¦ï¼Œå¦‚æœæ²¡æœ‰å®šä¹‰ã€‚

ğŸŸ¦ **å†…è”å‡½æ•°**

å…¶**å®šä¹‰**ä½äºç±»**å£°æ˜**ä¸­çš„å‡½æ•°éƒ½å°†è‡ªåŠ¨æˆä¸ºå†…è”å‡½æ•°ã€‚

ç±»å£°æ˜å¸¸å°†çŸ­å°çš„æˆå‘˜å‡½æ•°ä½œä¸ºå†…è”å‡½æ•°ã€‚

ğŸŸ¦ **æ„é€ å‡½æ•°**

> åå­—è·Ÿç±»åç›¸åŒã€‚
>
> æ²¡æœ‰è¿”å›å€¼ç±»å‹ã€‚
>
> è‡ªå®šä¹‰äº†æ„é€ å‡½æ•°ï¼Œç³»ç»Ÿå°±ä¸ä¼šå†è‡ªåŠ¨ç”Ÿæˆé»˜è®¤æ„é€ ã€‚

```c++
// æ˜¾å¼è°ƒç”¨æ„é€ å‡½æ•°:
Stock food = Stock("World Cabbage", 250, 1.25);

// éšå¼åœ°è°ƒç”¨æ„é€ å‡½æ•°:
Stock garment("Furry Mason", 50, 2.5);

// é»˜è®¤æ„é€ å‡½æ•°: å½“ä¸”ä»…å½“æ²¡æœ‰å®šä¹‰ä»»ä½•æ„é€ å‡½æ•°æ—¶
Stock cat;
```

<font color="green">**æ‹·è´æ„é€ **</font>

```c++
class MyClass {
public:
    int x;
    // æ‹·è´æ„é€ å‡½æ•°
    MyClass(const MyClass& other) {
        x = other.x;
    }
};

int main() {
    MyClass obj1(42); // æ™®é€šæ„é€ å‡½æ•°
    MyClass obj2(obj1); // æ‹·è´æ„é€ å‡½æ•°
    return 0;
}
```

<font color="green">**è½¬æ¢æ„é€ **</font>

```c++
// åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ„é€ å«è½¬æ¢æ„é€ 
class MyClass {
public:
    MyClass(int x) {
        // å°† int ç±»å‹çš„å€¼è½¬æ¢ä¸º MyClass ç±»å‹çš„å¯¹è±¡
    }
};

int main() {
    MyClass myObject = 10;  // ä½¿ç”¨è½¬æ¢æ„é€ å‡½æ•°å°† int ç±»å‹çš„å€¼è½¬æ¢ä¸º MyClass ç±»å‹çš„å¯¹è±¡
    myObject = myObject +'A' + false; // å°†char, booléƒ½è½¬æ¢ä¸ºMyClassç±»å‹å†è¿ç®—
    return 0;
}
```

ğŸŸ¦ **ææ„å‡½æ•°**

> å¯¹è±¡è¿‡æœŸæ—¶è‡ªåŠ¨è°ƒç”¨çš„ç‰¹æ®Šæˆå‘˜å‡½æ•° (åŒ…æ‹¬æ‰‹åŠ¨è°ƒç”¨deleteæ—¶)
>
> ææ„å‡½æ•°ä¸€èˆ¬ç”¨æ¥å®Œæˆæ¸…ç†å·¥ä½œ
>
> ææ„å‡½æ•°çš„åç§°æ˜¯åœ¨ç±»åå‰åŠ ä¸Š~
>
> ææ„å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œåªèƒ½æœ‰ä¸€ä¸ª
>
> è™šææ„ä½¿ç”¨deleteçˆ¶ç±»çš„æ—¶å€™æ‰èƒ½è°ƒç”¨å­ç±»ææ„

<font color="green">**ç±»å‹è½¬æ¢å‡½æ•°**</font>



<font color="green">**åˆå§‹åŒ–å‚æ•°åˆ—è¡¨**</font>

```c++
class Example {
public:
    Example(int a, int b) : num1(a), num2(b)
    {
        // num1 = a;
        // num2 = b;
    }

private:
    int num1;
    int num2;
}
```

ğŸŸ¦ **thisæŒ‡é’ˆ**

* æ¯ä¸ªæˆå‘˜å‡½æ•°( åŒ…æ‹¬æ„é€ å’Œææ„ )éƒ½æœ‰ä¸€ä¸ªthisæŒ‡é’ˆ
* thisæŒ‡é’ˆæŒ‡å‘è°ƒç”¨å¯¹è±¡ï¼Œå³å¯ä»¥é€šè¿‡thiså…³é”®å­—è®¿é—®å½“å‰å¯¹è±¡çš„æˆå‘˜
* thisæŒ‡é’ˆçš„ç±»å‹ä¸ºç±»ç±»å‹*const(const ç±»å\*), ä¸ºå³å€¼
* thisæŒ‡é’ˆæ˜¯ç±»æˆå‘˜å‡½æ•°çš„ç¬¬ä¸€ä¸ªé»˜è®¤éšå«å‚æ•°ï¼Œç¼–è¯‘å™¨è‡ªåŠ¨ç»´æŠ¤ä¼ é€’ï¼Œç±»ç¼–å†™è€…ä¸èƒ½æ˜¾å¼ä¼ é€’
* åªæœ‰åœ¨ç±»çš„éé™æ€æˆå‘˜å‡½æ•°ä¸­æ‰å¯ä»¥ä½¿ç”¨thisæŒ‡é’ˆï¼Œå…¶å®ƒä»»ä½•å‡½æ•°éƒ½ä¸å¯ä»¥

```c++
// è¿”å›å¯¹è±¡çš„å¼•ç”¨
class MyClass {
public:
    MyClass& getReference() {
        return *this;
    }
}
```

### 9.3 const

```c++
// 1. ä¿®é¥°å˜é‡
const int x = 10;
x = 20;      // ç¼–è¯‘é”™è¯¯ï¼Œxæ˜¯åªè¯»å˜é‡ï¼Œä¸èƒ½ä¿®æ”¹å…¶å€¼
const Stock land = Stock("Kludgehorn Properties");
land.show(); // ç¼–è¯‘é”™è¯¯ï¼Œæ— æ³•ä¿è¯è¿™ä¸ªæ–¹æ³•ä¸­ land ä¸­çš„æ•°æ®ä¸è¢«ä¿®æ”¹

// 2. ä¿®é¥°å‡½æ•°å‚æ•°
void func(const int x) {
    x = 20;  // ç¼–è¯‘é”™è¯¯ï¼Œxæ˜¯åªè¯»å‚æ•°ï¼Œä¸èƒ½ä¿®æ”¹å…¶å€¼ã€‚
    // å¦‚æœå‚æ•°æ˜¯constå¼•ç”¨ï¼Œåªèƒ½è°ƒç”¨è¯¥å¼•ç”¨å¯¹è±¡çš„constæˆå‘˜å’Œconstæ–¹æ³•ã€‚
}

// 3. ä¿®é¥°å‡½æ•°è¿”å›å€¼
const int func() {
    int x = 10;
    return x;
}

int main() {
    int value = func();
    value = 20;  // å¯ä»¥ä¿®æ”¹valueçš„å€¼ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹func()è¿”å›çš„å€¼
}

// 4. ä¿®é¥°æˆå‘˜å‡½æ•°(å¸¸å‡½æ•°)
class MyClass {
public:
    int x;
    mutable int y;

    void func() {
        x = 10;
    }

    void constFunc() const {
        // x = 10;  // ç¼–è¯‘é”™è¯¯ï¼Œä¸èƒ½åœ¨constæˆå‘˜å‡½æ•°ä¸­ä¿®æ”¹æˆå‘˜å˜é‡
        y = 10; // å¯ä»¥ä¿®æ”¹
    }
}

int main() {
    const MyClass obj;
    obj.func();  // ç¼–è¯‘é”™è¯¯ï¼Œä¸èƒ½åœ¨å¸¸é‡å¯¹è±¡ä¸Šè°ƒç”¨éconstæˆå‘˜å‡½æ•°
    obj.constFunc();  // å¸¸é‡å¯¹è±¡è°ƒç”¨å¸¸å‡½æ•°
}
```

### 9.4 ç±»å‹è½¬æ¢

```c++
// è‡ªåŠ¨ç±»å‹è½¬æ¢
long count = 8;       // long
double time = 11;     // double
int side = 3.33;      // int
int * p = (int *) 10; // int *, ä½†æ²¡æœ‰æ„ä¹‰

Stonewt blossem(132.5);   // è°ƒç”¨æ„é€ 
Stonewt buttercup(10ï¼Œ2); // è°ƒç”¨æ„é€ 
Stonewt bubbles;          // è°ƒç”¨æ„é€ 

// åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ‰èƒ½è‡ªåŠ¨è½¬æ¢
Stonewt myCat;      // create a Stonewt object
myCat = 19.6;       // Stonewt(double) to convert 19.6 to Stonewt

// explicit å…³é—­è‡ªåŠ¨è½¬æ¢
explicit Stonewt(double lbs); // no implicit conversions allowed
mycat =(Stonewt)19.6;         // å¯ä»¥ï¼Œå› ä¸ºæ˜¯å¼ºåˆ¶ç±»å‹è½¬æ¢
```

ğŸŸ© **è½¬æ¢å‡½æ•°**

`operator typeName();`

* è½¬æ¢å‡½æ•°å¿…é¡»æ˜¯ç±»æ–¹æ³•
* è½¬æ¢å‡½æ•°ä¸èƒ½æŒ‡å®šè¿”å›ç±»å‹
* è½¬æ¢å‡½æ•°ä¸èƒ½æœ‰å‚æ•°

```c++
class ...
operator double();
...
Stonewt::operator double() const
{
    return pounds;
}

Stonewt poppins(9,2.8);
double pwt = poppins;      // implicit conversion
```

### 9.5 ç±»æ¨¡æ¿

```c++
template <typename NameType, typename AgeType>
class Person
{
public:
    Person(NameType name, AgeType age)
    {

    }
}

Person<string, int> p1("sunwukong", 999);
```

## 10. è¿ç®—ç¬¦é‡è½½

å¯¹äºå†…ç½®æ•°æ®ç±»å‹ä¸èƒ½å®ç°è¿ç®—ç¬¦é‡è½½ã€‚

**åŠ å·è¿ç®—ç¬¦+**

```c++
class MyClass {
public:
    int value;
    MyClass(int num) {
        value = num;
    }

    // å·¦ä¾§çš„æ“ä½œæ•°æ˜¯è°ƒç”¨å¯¹è±¡
    MyClass operator+(const MyClass& other) {
        MyClass result(value + other.value);
        return result;
    }

    friend MyClass operator+(int num, const MyClass& obj);
};

// å…¨å±€è¿ç®—ç¬¦é‡è½½å®ç°
MyClass operator+(int num, const MyClass& obj) {
    return MyClass(num + obj.value);
}

int main() {
    MyClass obj1(10);
    MyClass obj2(20);

    // ç­‰äºæ›¿æ¢ä¸Š obj1.operator+(obj2);
    MyClass result = obj1 + obj2; // è¿”å› resultï¼Œ value æˆå‘˜å˜é‡ä¸º 30

    MyClass result = 10 + obj2; // operator+(10, obj2);
}
```

**å·¦ç§»è¿ç®—ç¬¦<<**

```c++
ostream& operator<<(ostream &cout, Object &other)
{
    cout << "data: " << obj.data;
    return cout;
}

class Object {
private:
    int data;
public:
    friend ostream& operator<<(ostream& out, const Object& obj);
};
```

**é€’å¢è¿ç®—ç¬¦++**

```c++
Object& operator++()
{
    //è¯­å¥
    return
}
Object operator++(int) //åç½®é€’å¢ï¼Œä¸è¦è¿”å›å¼•ç”¨
{
    //è¯­å¥
    return
}
```

**èµ‹å€¼è¿ç®—ç¬¦=**

```c++
new int(); // è¿”å›çš„æ˜¯ int *
Object& operator=(Object &other)
{
    if (this != &other) {
         name_ = other.name_;
         age_ = other.age_;
    }
    return *this;
}
```

**ä»¿å‡½æ•°()**

```c++
void operation()(string test)
{

}
å¯¹è±¡å("AAA"); // è°ƒç”¨
```

![](../imgs/Cpp/overloadoperation.jpg)

![](../imgs/Cpp/nooverloadoperation.jpg)



## 11. æ–‡ä»¶æ“ä½œ

ğŸŸ¦ **æ–‡æœ¬æ–‡ä»¶**

æ–‡æœ¬ä»¥ASCIIç çš„å½¢å¼å­˜å‚¨åœ¨è®¡ç®—æœºä¸­ã€‚

```c++
#include <fstream> // è¯»å†™æµ
ofstream ofs;      // å†™
ofs.open("æ–‡ä»¶è·¯å¾„", ios::out); // åˆ›å»ºæˆ–è€…é‡å†™æ–‡ä»¶
ofs << "å†…å®¹1" << endl;
ofs << "å†…å®¹2" << endl;
ofs.close();
```

```c++
#include <fstream>
ifstream ifs       // è¯»
ifs.open("æ–‡ä»¶è·¯å¾„", ios::in);
if(ifs.is_open()){
    char buf[1024] = {0};
    // ç¬¬ä¸€ç§
    while (ifs >> buf){
        cout << buf << endl;
    }
    // ç¬¬äºŒç§
    while (ifs.getline(buf, sizeof(buf))){
        cout << buf << endl;
    }
    // ç¬¬ä¸‰ç§
    string buf;
    while (getline(ifs, buf)){ 
        cout << buf << endl;
    }
    // ç¬¬å››ç§
    char c;
    while ((c = ifs.get()) != EOF){ 
        cout << c;
    }
}
ifs.close();
```

ğŸŸ¦ **äºŒè¿›åˆ¶æ–‡ä»¶**

äºŒè¿›åˆ¶å­˜å‚¨ï¼Œæ— æ³•è¯»æ‡‚ã€‚

åŒç†ï¼šåªéœ€è¦ä½¿ç”¨ `ofs.open("æ–‡ä»¶è·¯å¾„", ios::out | ios::binary);`

## 12. å†…å­˜

**C++ç¨‹åºåœ¨æ‰§è¡Œæ—¶ï¼Œ å°†å†…å­˜å¤§æ–¹å‘åˆ’åˆ†ä¸º4ä¸ªåŒºåŸŸ**

ç¨‹åºè¿è¡Œå‰ï¼š

* **ä»£ç åŒº**ï¼šå­˜æ”¾å‡½æ•°ä½“çš„äºŒè¿›åˆ¶ä»£ç ï¼Œç”±æ“ä½œç³»ç»Ÿè¿›è¡Œç®¡ç†çš„ã€‚ï¼ˆåªè¯»ï¼‰
* **å…¨å±€åŒº**ï¼šå­˜æ”¾å…¨å±€å˜é‡å’Œé™æ€å˜é‡ä»¥åŠå¸¸é‡

ç¨‹åºè¿è¡Œæ—¶ï¼š

* **æ ˆåŒº**ï¼šç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…é‡Šæ”¾ï¼Œ å­˜æ”¾å‡½æ•°çš„å‚æ•°å€¼,å±€éƒ¨å˜é‡ç­‰
* **å †åŒº**ï¼šç”±ç¨‹åºå‘˜åˆ†é…å’Œé‡Šæ”¾,è‹¥ç¨‹åºå‘˜ä¸é‡Šæ”¾,ç¨‹åºç»“æŸæ—¶ç”±æ“ä½œç³»ç»Ÿå›æ”¶

==========
