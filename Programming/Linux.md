# Linux

## 1. 简介

​    1991年，芬兰人linus.
​    只要用了内核都叫linux.
​    1971年，C语言发布，Unix1973年都用C重写了。

## 2. Linux 系统安装

### 2.1 VMware

VMware 是一个虚拟PC的软件。www.vmware.com 从而实现若干个独立的操作系统。

> CPU:   建议1GHz以上
> 内存：1GB以上
> 硬盘：8GB以上

### 2.2 VMware安装

VMware8.0: 
`Typical --> `
新建虚拟机：`标准 --> 我以后再安装操作系统 --> 客户机操作系统linux --> CentOS(or other2.6内核) --> 虚拟机名称，保存位置 --> 最大磁盘空间：20G，虚拟机拆分多个文件 --> 完成`
虚拟机硬件调整：

> 虚拟机内存: 不能是电脑内存一半，最少128M. 推荐 628M
> 处理器数量：1。
> 处理器核数：1。
> 硬盘：随意。
> 光驱：设备状态：打开电源时连接。连接: ISO镜像。
> 网络适配器：NAT. 

虚拟机快照：直接恢复至该设置状态点。
克隆：一个一模一样的虚拟机。完整克隆。（链接克隆：只占用实际大小，原始机删除克隆机不能用）

## 3. 磁盘分区

### 3.1 分区

把大硬盘分成为小的逻辑分区，一个硬盘分成多个硬盘。

> 主分区： 最多4个。
> 扩展分区：
> 
> > 最多1个。
> > 主分区 + 扩展分区最多有4个。
> > 不能写入数据，只能包含逻辑分区。
> 
> 逻辑分区：从编号5开始。

### 3.2 格式化

写入文件系统：在磁盘特定区域写特定数据。

### 3.3 分配盘符

分区设备文件名: 给每个分区定义设备文件名。

### 3.4 挂载

给每个分区分配挂载点。
必须分区:

> / ：根分区
> swap分区：交换分区，内存两倍，不超过2GB

推荐分区：/boot 启动分区，200MB

## 4. 系统安装

> ISO镜像 --> F2进入BIOS (主板的操作系统) --> Boot (Ctrl + alt 切换虚拟机光标与本地机器) --> CD-ROM driver --> Exit exit saving changes (安装完， BIOS改回 硬盘启动，但是虚拟机会自动识别CD还是 硬盘启动)
> 
> 1. 欢迎界面 
> 
> > "Install or upgrade an existing system" :安装或升级现有系统 (selected)
> > "Install system with basic video driver" :安装过程采用基本的显卡驱动
> > "Rescue installed system” :进入系统修复模式
> > "Boot from local drive" :退出安装从硬盘启动
> > "Memory test” :存储介质检测
> 
> 2. 基本存储，默认主机名，创建自定义布局，标准分区-> 挂载点 (1. /boot 分区自动为 sda1 200M, 2. swap没有盘符, 3. /home 2G，4. / 200M), 格式化，引导程序位置默认，需要安装的软件选basic server。完成
> 3. 重新引导。

## 5. 远程登录管理

### 5.1 网络配置

1. 桥接：利用真实网卡连接，可以与外部连接。占用一个真实网段IP
2. NAT: 利用虚拟网卡连接，与真实机通讯。
3. Host-Only: 只能与真实机通讯。

​    ifconfig: interface config
​        本机：127.0.0.1
​    `ifconfig eth0 VMnet1的地址`：第一块卡 eth （重启之后IP丢失）
​    如果是桥接，`ifconfig eth0 真实机的IP同一网段的地址`  

## 6. 目录

硬盘文件：/dev/sd[a-p]
光盘文件：/dev/sr0
没有扩展名的概念，不是像Windows一样靠扩展名区别文件类型。（压缩包、rpm、脚本文件会有扩展名，但是非必须）

| /bin/        | bin中是二进制文件，也就是可以执行的文件。所有用户可以执行           |
| ------------ | ---------------------------------------- |
| /sbin/       | 只有超级用户可以使用                               |
| /usr/bin/    | 这些命令和系统启动无关                              |
| /usr/sbin/   | ...                                      |
| /boot/       | 系统启动目录                                   |
| /dev/        | 设备文件保存目录                                 |
| /etc/        | 配置文件保存目录                                 |
| /home/       | 普通用户家目录 （/root/ root的home目录）             |
| /lib/        | 函数库                                      |
| /lost+found/ | 系统奔溃的碎片文件                                |
| /media/      | 挂载目录。多媒体设备                               |
| /mnt/        | 挂载目录。U盘                                  |
| /misc/       | 挂载目录。NFS                                 |
| /opt/        | 第三方安装软件保存目录。或者 /usr/local                |
| /proc/       | 虚拟文件系统，**内存中**。系统信息                      |
| /sys/        | 虚拟文件系统，**内存中**。内核相关信息                    |
| /srv/        | 服务数据目录                                   |
| /tmp/        | 临时目录                                     |
| /usr/        | 系统软件资源目录，注意不是user。Unix Software Resource |
| /var/        | 动态数据保存位置。例如日志。                           |

防火墙：通过IP过滤

## 7. 命令

### 7.1 常用命令

命令格式: `命令 [-选项] [参数]`

| ls -a                   | list的意思, all的意思                                                                                                          |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------ |
| ls [ / ]                | 可以指定任何目录, 例如 根目录 /。                                                                                                      |
| ls -l                   | l: long的意思，详细信息<br/>信息解释：<br/>1：引用计数<br/>- ：表示文件<br/>d: directory<br/>l: 软链接<br/>u: user, g:group, o:other, r:读 w:写 x执行。 |
| ls -d                   | d：directory 查看这个目录详细信息。                                                                                                  |
| ls -i                   | 文件的ID，node                                                                                                               |
| mkdir -p                | 递归创建。 cd: change directory，pwd: print working directory                                                                  |
| rmdir                   | remove empty directories                                                                                                 |
| cp -rp [原文件或目录] [新文件目录] | copy，r: 递归地，p：保留复制文件的属性，例如文件修改时间。                                                                                        |
| touch 文件名               | 创建文件。需要创建带空格的文件需要把文件名用引号框起来。                                                                                             |
| cat [-n] [文件名]          | 查看文件。 n: 显示行号                                                                                                            |
| tac                     | 反向显示。                                                                                                                    |
| more [文件名]              | 查看长文件。空格或者f翻页，enter 换行，q或者Q退出。                                                                                           |
| less                    | 额外。可以向上翻页page up。箭头上一行。<br/>/名字搜索；n :下一个。N：上一个。                                                                          |
| head -n 数字              | 指定查看几行。默认前十行。tail: 看后几行，-f, 动态显示末尾几行。                                                                                    |

### 7.2 链接

| ln -s [原文件] [目标文件] | 软链接。类似于Windows的快捷方式。可以是目录。权限是777<br/>没有-s是硬链接。会跟原文件同步。不可以是目录。 |
| ------------------ | ------------------------------------------------------------- |
| ls -i              | 可以通过节点判断是不是硬链接。node相同。                                        |

### 7.2 权限

| chmod u+x 文件名  | 文件所有者或者root。<br/>ugoa: user,group, other and all. 可以用逗号隔开同时操作ugoa+-=rwx<br/>+-= : 增加或者减少或者指定这个权限。<br/>rwx: 读写执行。421.<br/>-R: 递归修改。 |
| -------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| chown 新用户名 文件名 |                                                                                                                                    |
| chgrp 新组名 文件名  |                                                                                                                                    |
| umask -S       | 默认的创建后的文件的权限。文件的默认权限都去除x.                                                                                                          |

### 7.3 搜索

| find 搜索范围 匹配条件                | -name 文件名搜索？？？ 匹配三个字符<br/>-iname 不区分大小写搜索<br/>* ：匹配多个字符。？：匹配单个字符。<br/>-size +2048： 大于小于多少数据块。一个数据块512字节，0.5K. 数据块，linux存储文件最小单位。<br/>-user: 找所有者。-group: 所属组查找。<br/>-amin -5: 访问时间access。<br/>-cmin：文件属性 change.<br/>-mmin: 文件内容 modify.<br/>-a：用于 and 两个条件。同理：-o：表示or<br/>-type: 文件类型。f 文件，d 目录，l 软链接<br/>-inum: 根据I节点删除。 |
| ----------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| -exec 命令 {}\；<br/>-ok 命令 {}\； | 找到之后再操作。<br/>需要确认的。                                                                                                                                                                                                                                                                                                        |
| locate                        | 有自己的资料库。updatedb主动更新它。不能找到/tmp下面的。                                                                                                                                                                                                                                                                                         |
| -i                            | ignore：不区分大小写。<br/>inquest：                                                                                                                                                                                                                                                                                                |
| which 命令                      | 搜索命令所在目录以及别名信息。**找不到Shell的内置命令**。                                                                                                                                                                                                                                                                                          |
| whereis 命令                    | 命令或者配置文件位置和帮助文档所在位置。man1: 命令的帮助。man5: 配置的帮助。                                                                                                                                                                                                                                                                               |
| grep -iv [^指定字串][文件]          | 在文件中搜索字符串匹配的行并输出。<br/>-i: 不区分大小写。<br/>-v: 排除指定字串。<br/>^：以某某开头。<br/>-n：显示行号。                                                                                                                                                                                                                                                |

### 7.4 帮助

| man [数字] 命令或者配置文件 | manual，配置文件不要加绝对路径信息。 |
| ----------------- | --------------------- |
| whatis 命令         | 命令简短的信息。              |
| apropos 配置        | 配置文件简短信息。             |
| --help            | 只看option的信息。          |
| info              | 后来出的命令。<br/>          |
| help 命令           | Shell内置命令。            |

### 7.5 用户管理

| useradd      | 增加用户。                                                               |
| ------------ | ------------------------------------------------------------------- |
| passwd [用户名] | 修改用户名的密码。                                                           |
| who          | 多少人登录了当前设备。<br/>tty: 本地终端登录。pts: 远程终端登录。<br/>信息解释：<br/>PCPU: cpu时间。 |
| w            | 更多详细登录信息。                                                           |
| uptime       | 连续运行的时间。                                                            |

### 7.6 压缩解压

| gzip 文件名<br/>gunzip 文件名                                            | .gz 格式。 压缩与解压缩。不能压缩目录。不保留原文件。<br/>gzip -d: 也是解压缩。             |
| ------------------------------------------------------------------ | ------------------------------------------------------------- |
| tar -cvf 压缩后文件名 目录名                                                | .tar 打包文件夹。<br/>-c: 打包。-v：显示详细信息。-f: 指定文件名。-z: 打包同时压缩。-x: 解压。 |
| zip [-r] 压缩后文件名 文件或者目录<br/>unzip                                   | zip linux和win同时支持。-r: 压缩目录<br/>解压缩。                           |
| bzip2 [-k] 文件名<br/>tar -cjvf 压缩包<br/>bunzip2 文件名<br/>tar -xjvf 压缩包 | .bz2 压缩比惊人。-k keep: 保留原文件。                                    |

### 7.7 网络

| write 用户名        | 给在线用户发信息。Ctrl+D结束保存发送。                                                 |
| ---------------- | ---------------------------------------------------------------------- |
| wall 内容          | write all                                                              |
| ping [-c 次数] ip  |                                                                        |
| ifconfig         | eth0: 真实网卡。HWaddr：mac地址。inet addr: 网址。<br/>lo: loopback网卡。127.0.0.1固定的 |
| mail 用户名         | Ctrl+D结束保存发送。<br/>mail： 看邮件。help: 帮助。                                  |
| last             | 所有用户登录信息。                                                              |
| lastlog [-u uid] | 所有用户最后一次登录时间。                                                          |
| traceroute 网站地址  | 显示数据包到主机间的路径。                                                          |
| netstat          | /                                                                      |
| setup            | redhat 特有。                                                             |
| mount            |                                                                        |

### 7.8 关机重启

| shutdown [选项] 时间<br/> | -h:halt 关机  指定时间，例如12：00, now<br/>-c： 取消前一个关机命令。-r : 重启。 |
| --------------------- | -------------------------------------------------------- |
| init 6                | = shutdown -r now = reboot<br/>/etc/inittab 系统默认运行级别。    |
| runlevel              | 查询系统运行级别。                                                |

## 8. vim

vim编辑器。命令 vi = vim
aio: 由命令模式变插入模式。Esc：退出插入模式。

| a         | 在光标所在字符后插入      | 光标+y。 yy。nyy                    | 复制选中的。复制当前行or n行                                                                               |
| --------- | --------------- | ------------------------------- | ---------------------------------------------------------------------------------------------- |
| A         | 在光标所在行尾插入       | p,P                             | 粘贴在上或者下行                                                                                       |
| i         | 在光标所在字符前插入      | dd，ndd                          | 剪切。                                                                                            |
| I         | 在光标所在行行首插入      | r                               | 替换一个字符                                                                                         |
| o         | 在光标下插入新行        | R                               | 持续替换字符，Esc结束                                                                                   |
| O         | 在光标上插入新行        | u                               | 撤销                                                                                             |
| :set nu   | 设置行号            | /                               | 搜索。n下一个。:set ic然后再搜就忽略了大小写。                                                                    |
| :set nonu | 不要行号            | :%s/old/new/g<br/>:%s/old/new/c | 全文替换字符串。<br/>每个都询问。                                                                            |
| gg        | 到第一行            | :n1,n2s/old/new/g               | 范围内替换。                                                                                         |
| G         | 到最后一行           | :w newFilename                  | 另存为。                                                                                           |
| nG        | 到第N行            | ZZ                              | 保存修改并退出。                                                                                       |
| ：n        | 到第N行            | :r 文件名                          | 导入一个文件的内容到这个文件中。                                                                               |
| $         | 移动到行首           | :!which 命令                      | 不退出VI情况下也可以使用命令。                                                                               |
| 0         | 移动到行尾           | :r !date                        | 直接将date的结果导入了。                                                                                 |
| x         | 删除字符 or nx 多个字符 | map 按ctrl+v+快捷键 I#<Esc>         | 定义了ctrl+快捷键的：ctrl+快捷键，立马做了行首插入#然后Esc                                                           |
| dd        | 删除行。ndd         | :n1,n2s/^/#/g<br/>:n1,n2s/^#//g | 快速注释。                                                                                          |
| dG        | 删除光标所在行到末尾内容。   | :ab 变量名 字面量                     |                                                                                                |
| D         | 删除光标所在到行末尾。     | ~/.vimrc                        | 持久化的配置文件。                                                                                      |
| ：n1,n2d   | 删除指定范围行。        | v<br/>                          | visual模式, 使用 j/k/h/l键可以选中一块。<br/>复制：y。粘贴：p。d：剪切。<br/>使用按键j/k/h/l进行选中多列， 按键Shift + i 进行 块模式下的插入 |

## 9. 软件包。

分类：源码包--脚本安装包。二进制包--RPM包，系统默认包。

## ssss

| Ctrl+A/E | 光标去命令行首/尾 |
| -------- | --------- |
|          |           |


